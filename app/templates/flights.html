<!-- templates/index.html -->

{% extends "base.html" %}

{% block content %}
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="hero-text">
                        <img src="/static/img/placeholder.png" alt="">
                        <h1>Where to next?</h1>
                        <form action="{{ url_for('flightsearch') }}" class="filter-search flights" method="post">
                            <div class="flight-mode">
                                <ul class="col-lg-12" style="display: inline-flex; list-style-type: none;">
                                        <input  type="radio" name="type" value="oneway" checked="checked"> One Way
                                        <input type="radio" name="type" value="roundtrip"> Round Trip
                                </ul>
                            </div>
                            <div class="category-search" style="width: 25%; !important">
                                <h5>From:</h5>
                                <input type="text" name="from" id="myInput" onkeyup="myFunction()" placeholder="From">
                                <ul id="myUL">
                                <li onclick="set(1)"><a href="#">Adele</a></li>
                                <li><a href="#">Agnes</a></li>
                                <li><a href="#">Billy</a></li>
                                <li><a href="#">Bob</a></li>
                                <li><a href="#">Calvin</a></li>
                                <li><a href="#">Christina</a></li>
                                <li><a href="#">Cindy</a></li>
                                </ul>
                                <div class="category-search" style="width: 100%; margin-top:10px;">
                                <h6 style="color: white">Traveller(s) , class:  </h6>
                                <select id="abc" class="lo-search" >
                                        <option>Economy</option>
                                        <option>Buisness</option>
                                    </select>

                                </div>
                            </div>


                            <div class="category-search" style="width: 500px; !important">
                                    <div class="location-search" style="width:258px;">
                                <h5>To:</h5>
                                        <input type="text" name="to" id="myInput1" onkeyup="myFunction()" placeholder="From">
                                <ul id="myUL1">
                                <li onclick="set(1)"><a href="#">Adele</a></li>
                                <li><a href="#">Agnes</a></li>
                                <li><a href="#">Billy</a></li>
                                <li><a href="#">Bob</a></li>
                                <li><a href="#">Calvin</a></li>
                                <li><a href="#">Christina</a></li>
                                <li><a href="#">Cindy</a></li>
                                </ul>
                                
                            </div>
                            <div class="category-search" style="width: 110px; !important">
                                <div class="depart">
                                    <h5>Depart:</h5>
                                      <form>
                                      <input type="date" name="tday" min={{dtoday}} style="font-size: 16px;
                                          font-size: 16px;
                                            width: 120px;
                                            font-weight: 500;
                                            height: 50px;
                                            color: white;
                                            background-color: transparent;
                                            border-right-width: 1px;
                                            border-right-color: lightsteelblue;">
                                      </form>
                                 </div>
                            </div>
                            <div class="category-search" style="width: 110px; !important">
                                    <div class="return">
                                        <h5>Return:</h5>
                                        <input type="date" name="rday" min={{dtoday}} style="width: 120px;
                                        height: 50px;
                                        font-size: 16px;background-color: transparent;
                                        color: white;
                                        font-weight: 500;">
                                    </div>
                                </div>

                            <button type="submit" style="top:95px; !important"><a style="color: white" href="{{ url_for('flightsearch') }}">Search Now</a></button>
                        </form>

                    </div>
                </div>
            </div>
        </div>


<script>
    function myFunction() {
      // Declare variables
      var input, filter, ul, li, a, i, txtValue;
      input = document.getElementById('myInput');
      filter = input.value.toUpperCase();
      ul = document.getElementById("myUL");
      ul.style.display="block";
      li = ul.getElementsByTagName('li');

      // Loop through all list items, and hide those who don't match the search query
      for (i = 0; i < li.length; i++) {
        a = li[i].getElementsByTagName("a")[0];
        txtValue = a.textContent || a.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          li[i].style.display = "";
        } else {
          li[i].style.display = "none";
        }
      }
    }

    function set(a){
        input = document.getElementById('myInput');
        input.value="Adele";
        if(a==1){
            input.value="Adele";
            ul = document.getElementById("myUL");
            ul.style.display="none";
        }
    }
    </script>


<script>

function filterFunction(that, event) {
        let container, input, filter, li, input_val;
        container = $(that).closest(".searchable");
        input_val = container.find("input").val().toUpperCase();
    
        if (["ArrowDown", "ArrowUp", "Enter"].indexOf(event.key) != -1) {
            keyControl(event, container)
        } else {
            li = container.find("ul li");
            li.each(function (i, obj) {
                if ($(this).text().toUpperCase().indexOf(input_val) > -1) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
    
            container.find("ul li").removeClass("selected");
            setTimeout(function () {
                container.find("ul li:visible").first().addClass("selected");
            }, 100)
        }
    }
    
    function keyControl(e, container) {
        if (e.key == "ArrowDown") {
    
            if (container.find("ul li").hasClass("selected")) {
                if (container.find("ul li:visible").index(container.find("ul li.selected")) + 1 < container.find("ul li:visible").length) {
                    container.find("ul li.selected").removeClass("selected").nextAll().not('[style*="display: none"]').first().addClass("selected");
                }
    
            } else {
                container.find("ul li:first-child").addClass("selected");
            }
    
        } else if (e.key == "ArrowUp") {
    
            if (container.find("ul li:visible").index(container.find("ul li.selected")) > 0) {
                container.find("ul li.selected").removeClass("selected").prevAll().not('[style*="display: none"]').first().addClass("selected");
            }
        } else if (e.key == "Enter") {
            container.find("input").val(container.find("ul li.selected").text()).blur();
            onSelect(container.find("ul li.selected").text())
        }
    
        container.find("ul li.selected")[0].scrollIntoView({
            behavior: "smooth",
        });
    }
    
    function onSelect(val) {
        alert(val)
    }
    
    $(".searchable input").focus(function () {
        $(this).closest(".searchable").find("ul").show();
        $(this).closest(".searchable").find("ul li").show();
    });
    $(".searchable input").blur(function () {
        let that = this;
        setTimeout(function () {
            $(that).closest(".searchable").find("ul").hide();
        }, 300);
    });
    
    $(document).on('click', '.searchable ul li', function () {
        $(this).closest(".searchable").find("input").val($(this).text()).blur();
        onSelect($(this).text())
    });
    
    $(".searchable ul li").hover(function () {
        $(this).closest(".searchable").find("ul li.selected").removeClass("selected");
        $(this).addClass("selected");
    });</script>
        {% endblock %}
